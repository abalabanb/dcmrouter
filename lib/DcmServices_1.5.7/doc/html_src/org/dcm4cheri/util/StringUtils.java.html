<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">
<HTML>
<HEAD>
<LINK REL=STYLESHEET TYPE="text/css" HREF="../../../stylesheet.css" TITLE="Style">
<META NAME="GENERATOR" CONTENT="Java2HTML Version 1.0.9">
<TITLE>org.dcm4cheri.util.StringUtils (Java2HTML)</TITLE>
</HEAD>
<BODY><TABLE id="Header" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2" width="33%">&nbsp;</td>
<td align="center" colspan="2" width="33%">
<font size="4">StringUtils</font>
</td>
<td align="right" colspan="2" width="33%"></td>
</tr>
</TABLE>
<pre ID="Classes">
<A NAME="1"></A><FONT ID="MultiLineComment">/* ***** BEGIN LICENSE BLOCK *****
<A NAME="2"></A> * Version: MPL 1.1/GPL 2.0/LGPL 2.1
<A NAME="3"></A> *
<A NAME="4"></A> * The contents of this file are subject to the Mozilla Public License Version
<A NAME="5"></A> * 1.1 (the "License"); you may not use this file except in compliance with
<A NAME="6"></A> * the License. You may obtain a copy of the License at
<A NAME="7"></A> * http://www.mozilla.org/MPL/
<A NAME="8"></A> *
<A NAME="9"></A> * Software distributed under the License is distributed on an "AS IS" basis,
<A NAME="10"></A> * WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License
<A NAME="11"></A> * for the specific language governing rights and limitations under the
<A NAME="12"></A> * License.
<A NAME="13"></A> *
<A NAME="14"></A> * The Original Code is part of dcm4che, an implementation of DICOM(TM) in
<A NAME="15"></A> * Java(TM), hosted at http://sourceforge.net/projects/dcm4che.
<A NAME="16"></A> *
<A NAME="17"></A> * The Initial Developer of the Original Code is
<A NAME="18"></A> * TIANI Medgraph AG.
<A NAME="19"></A> * Portions created by the Initial Developer are Copyright (C) 2002-2005
<A NAME="20"></A> * the Initial Developer. All Rights Reserved.
<A NAME="21"></A> *
<A NAME="22"></A> * Contributor(s):
<A NAME="23"></A> * Gunter Zeilinger &lt;gunter.zeilinger@tiani.com&gt;
<A NAME="24"></A> *
<A NAME="25"></A> * Alternatively, the contents of this file may be used under the terms of
<A NAME="26"></A> * either the GNU General Public License Version 2 or later (the "GPL"), or
<A NAME="27"></A> * the GNU Lesser General Public License Version 2.1 or later (the "LGPL"),
<A NAME="28"></A> * in which case the provisions of the GPL or the LGPL are applicable instead
<A NAME="29"></A> * of those above. If you wish to allow use of your version of this file only
<A NAME="30"></A> * under the terms of either the GPL or the LGPL, and not to allow others to
<A NAME="31"></A> * use your version of this file under the terms of the MPL, indicate your
<A NAME="32"></A> * decision by deleting the provisions above and replace them with the notice
<A NAME="33"></A> * and other provisions required by the GPL or the LGPL. If you do not delete
<A NAME="34"></A> * the provisions above, a recipient may use your version of this file under
<A NAME="35"></A> * the terms of any one of the MPL, the GPL or the LGPL.
<A NAME="36"></A> *
<A NAME="37"></A> * ***** END LICENSE BLOCK ***** */</FONT>
<A NAME="38"></A>
<A NAME="39"></A><FONT ID="Package">package</FONT> <A HREF="../../../org.dcm4cheri.util.index.html" target="packageFrame">org.dcm4cheri.util</A>;
<A NAME="40"></A>
<A NAME="41"></A><FONT ID="Import">import</FONT> org.dcm4che.dict.Tags;
<A NAME="42"></A><FONT ID="Import">import</FONT> org.dcm4che.dict.VRs;
<A NAME="43"></A>
<A NAME="44"></A><FONT ID="Import">import</FONT> java.nio.ByteBuffer;
<A NAME="45"></A><FONT ID="Import">import</FONT> java.nio.ByteOrder;
<A NAME="46"></A><FONT ID="Import">import</FONT> java.nio.CharBuffer;
<A NAME="47"></A><FONT ID="Import">import</FONT> java.nio.charset.Charset;
<A NAME="48"></A>
<A NAME="49"></A><FONT ID="FormalComment">/**
<A NAME="50"></A> *
<A NAME="51"></A> * @author  gunter.zeilinger@tiani.com
<A NAME="52"></A> * @version 1.0.0
<A NAME="53"></A> */</FONT>
<A NAME="54"></A><FONT ID="Public">public</FONT> <FONT ID="Class">class</FONT> StringUtils {
<A NAME="55"></A>
<A NAME="56"></A>    <FONT ID="FormalComment">/** Prevent instances of Utility class */</FONT>
<A NAME="57"></A>    <FONT ID="Private">private</FONT> StringUtils() {
<A NAME="58"></A>    }
<A NAME="59"></A>    
<A NAME="60"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> StringBuffer promptBytes(StringBuffer sb, <FONT ID="Byte">byte</FONT>[] data,
<A NAME="61"></A>            <FONT ID="Int">int</FONT> start, <FONT ID="Int">int</FONT> length, <FONT ID="Int">int</FONT> maxlen) {
<A NAME="62"></A>        <FONT ID="If">if</FONT> (length == <FONT ID="IntegerLiteral">0</FONT>)
<A NAME="63"></A>            <FONT ID="Return">return</FONT> sb;
<A NAME="64"></A>        Tags.toHexString(sb, data[start] &amp; <FONT ID="IntegerLiteral">0xff</FONT>, <FONT ID="IntegerLiteral">2</FONT>);
<A NAME="65"></A>        <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = start+<FONT ID="IntegerLiteral">1</FONT>, remain = Math.min(length, (maxlen-<FONT ID="IntegerLiteral">2</FONT>)/<FONT ID="IntegerLiteral">3</FONT>);
<A NAME="66"></A>               --remain &gt; <FONT ID="IntegerLiteral">0</FONT>; ++i)
<A NAME="67"></A>            Tags.toHexString(sb.append(<FONT ID="CharacerLiteral">'\\'</FONT>), data[i] &amp; <FONT ID="IntegerLiteral">0xff</FONT>, <FONT ID="IntegerLiteral">2</FONT>);
<A NAME="68"></A>        
<A NAME="69"></A>        <FONT ID="SingleLineComment">// if limited by maxlen
<A NAME="70"></A></FONT>        <FONT ID="If">if</FONT> (sb.length() &lt; <FONT ID="IntegerLiteral">3</FONT> * length - <FONT ID="IntegerLiteral">1</FONT>) {
<A NAME="71"></A>           sb.setLength(maxlen-<FONT ID="IntegerLiteral">2</FONT>);
<A NAME="72"></A>           sb.append(<FONT ID="StringLiteral">".."</FONT>);
<A NAME="73"></A>        }
<A NAME="74"></A>        <FONT ID="Return">return</FONT> sb;
<A NAME="75"></A>    }
<A NAME="76"></A>
<A NAME="77"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String promptBytes(<FONT ID="Byte">byte</FONT>[] data, <FONT ID="Int">int</FONT> start, <FONT ID="Int">int</FONT> length,
<A NAME="78"></A>         <FONT ID="Int">int</FONT> maxlen)
<A NAME="79"></A>    {
<A NAME="80"></A>        <FONT ID="If">if</FONT> (length == <FONT ID="IntegerLiteral">0</FONT>)
<A NAME="81"></A>            <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">""</FONT>;
<A NAME="82"></A>        <FONT ID="Return">return</FONT> promptBytes(<FONT ID="New">new</FONT> StringBuffer(Math.min(maxlen, length * <FONT ID="IntegerLiteral">3</FONT> - <FONT ID="IntegerLiteral">1</FONT>)),
<A NAME="83"></A>               data, start, length, maxlen).toString();
<A NAME="84"></A>    }
<A NAME="85"></A>
<A NAME="86"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String promptBytes(<FONT ID="Byte">byte</FONT>[] data, <FONT ID="Int">int</FONT> start, <FONT ID="Int">int</FONT> length)
<A NAME="87"></A>    {
<A NAME="88"></A>       <FONT ID="Return">return</FONT> promptBytes(data, start, length, Integer.MAX_VALUE);
<A NAME="89"></A>    }
<A NAME="90"></A>    
<A NAME="91"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String truncate(String val, <FONT ID="Int">int</FONT> maxlen) {
<A NAME="92"></A>       <FONT ID="Return">return</FONT> val.length() &gt; maxlen ? (val.substring(<FONT ID="IntegerLiteral">0</FONT>, maxlen-<FONT ID="IntegerLiteral">2</FONT>) + <FONT ID="StringLiteral">".."</FONT>) : val;
<A NAME="93"></A>    }
<A NAME="94"></A>    
<A NAME="95"></A>    <FONT ID="Static">static</FONT> <FONT ID="Final">final</FONT> Charset ISO_8859_1 = Charset.forName(<FONT ID="StringLiteral">"ISO-8859-1"</FONT>);         
<A NAME="96"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String promptValue(<FONT ID="Int">int</FONT> vr, ByteBuffer bb) {
<A NAME="97"></A>       <FONT ID="Return">return</FONT> promptValue(vr, bb, ISO_8859_1, Integer.MAX_VALUE);
<A NAME="98"></A>    }
<A NAME="99"></A>    
<A NAME="100"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String promptValue(<FONT ID="Int">int</FONT> vr, ByteBuffer bb, Charset cs) {
<A NAME="101"></A>       <FONT ID="Return">return</FONT> promptValue(vr, bb, cs, Integer.MAX_VALUE);
<A NAME="102"></A>    }
<A NAME="103"></A>    
<A NAME="104"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String promptValue(<FONT ID="Int">int</FONT> vr, ByteBuffer bb, <FONT ID="Int">int</FONT> maxlen) {
<A NAME="105"></A>       <FONT ID="Return">return</FONT> promptValue(vr, bb, ISO_8859_1, maxlen);
<A NAME="106"></A>    }
<A NAME="107"></A>    
<A NAME="108"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String promptValue(<FONT ID="Int">int</FONT> vr, ByteBuffer bb, Charset cs,
<A NAME="109"></A>         <FONT ID="Int">int</FONT> maxlen)
<A NAME="110"></A>    {
<A NAME="111"></A>        <FONT ID="If">if</FONT> (bb.limit() == <FONT ID="IntegerLiteral">0</FONT>)
<A NAME="112"></A>            <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">""</FONT>;
<A NAME="113"></A>        
<A NAME="114"></A>        <FONT ID="If">if</FONT> (VRs.isStringValue(vr)) {
<A NAME="115"></A>            <FONT ID="If">if</FONT> (bb.get(bb.limit()-<FONT ID="IntegerLiteral">1</FONT>) == <FONT ID="IntegerLiteral">0</FONT>)
<A NAME="116"></A>                bb.limit(bb.limit()-<FONT ID="IntegerLiteral">1</FONT>);
<A NAME="117"></A>            <FONT ID="Return">return</FONT> truncate(cs.decode(bb).toString(), maxlen);
<A NAME="118"></A>        }
<A NAME="119"></A>        
<A NAME="120"></A>        <FONT ID="Switch">switch</FONT> (vr) {
<A NAME="121"></A>            <FONT ID="Case">case</FONT> VRs.AT:
<A NAME="122"></A>                <FONT ID="Return">return</FONT> promptAT(bb, maxlen);
<A NAME="123"></A>            <FONT ID="Case">case</FONT> VRs.FD:
<A NAME="124"></A>                <FONT ID="Return">return</FONT> promptFD(bb, maxlen);
<A NAME="125"></A>            <FONT ID="Case">case</FONT> VRs.FL:
<A NAME="126"></A>                <FONT ID="Return">return</FONT> promptFL(bb, maxlen);
<A NAME="127"></A>            <FONT ID="Case">case</FONT> VRs.OB: <FONT ID="Case">case</FONT> VRs.UN:
<A NAME="128"></A>                <FONT ID="Return">return</FONT> promptOB(bb, maxlen);
<A NAME="129"></A>            <FONT ID="Case">case</FONT> VRs.OF:
<A NAME="130"></A>                <FONT ID="Return">return</FONT> promptOF(bb, maxlen);
<A NAME="131"></A>            <FONT ID="Case">case</FONT> VRs.OW:
<A NAME="132"></A>                <FONT ID="Return">return</FONT> promptOW(bb, maxlen);
<A NAME="133"></A>            <FONT ID="Case">case</FONT> VRs.SL:
<A NAME="134"></A>                <FONT ID="Return">return</FONT> promptSL(bb, maxlen);
<A NAME="135"></A>            <FONT ID="Case">case</FONT> VRs.SS:
<A NAME="136"></A>                <FONT ID="Return">return</FONT> promptSS(bb, maxlen);
<A NAME="137"></A>            <FONT ID="Case">case</FONT> VRs.UL:
<A NAME="138"></A>                <FONT ID="Return">return</FONT> promptUL(bb, maxlen);
<A NAME="139"></A>            <FONT ID="Case">case</FONT> VRs.US:
<A NAME="140"></A>                <FONT ID="Return">return</FONT> promptUS(bb, maxlen);
<A NAME="141"></A>        }
<A NAME="142"></A>        <FONT ID="Throw">throw</FONT> <FONT ID="New">new</FONT> IllegalArgumentException(<FONT ID="StringLiteral">"VR:"</FONT> + VRs.toString(vr));
<A NAME="143"></A>    }
<A NAME="144"></A>
<A NAME="145"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String promptAT(ByteBuffer bb, <FONT ID="Int">int</FONT> maxlen) {
<A NAME="146"></A>        <FONT ID="Int">int</FONT> l = bb.limit() / <FONT ID="IntegerLiteral">4</FONT> * <FONT ID="IntegerLiteral">9</FONT> - <FONT ID="IntegerLiteral">1</FONT>;
<A NAME="147"></A>        <FONT ID="If">if</FONT> (l &lt; <FONT ID="IntegerLiteral">0</FONT>)
<A NAME="148"></A>            <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">""</FONT>;
<A NAME="149"></A>
<A NAME="150"></A>        StringBuffer sb = <FONT ID="New">new</FONT> StringBuffer(l);
<A NAME="151"></A>        bb.rewind();
<A NAME="152"></A>        Tags.toHexString(sb, bb.getShort() &amp; <FONT ID="IntegerLiteral">0xffff</FONT>, <FONT ID="IntegerLiteral">4</FONT>);
<A NAME="153"></A>        Tags.toHexString(sb, bb.getShort() &amp; <FONT ID="IntegerLiteral">0xffff</FONT>, <FONT ID="IntegerLiteral">4</FONT>);
<A NAME="154"></A>        <FONT ID="While">while</FONT> (bb.remaining() &gt;= <FONT ID="IntegerLiteral">4</FONT> &amp;&amp; sb.length() &lt; maxlen) {
<A NAME="155"></A>            Tags.toHexString(sb.append(<FONT ID="CharacerLiteral">'\\'</FONT>), bb.getShort() &amp; <FONT ID="IntegerLiteral">0xffff</FONT>, <FONT ID="IntegerLiteral">4</FONT>);
<A NAME="156"></A>            Tags.toHexString(sb, bb.getShort() &amp; <FONT ID="IntegerLiteral">0xffff</FONT>, <FONT ID="IntegerLiteral">4</FONT>);
<A NAME="157"></A>        }                
<A NAME="158"></A>        <FONT ID="Return">return</FONT> truncate(sb.toString(), maxlen);        
<A NAME="159"></A>    }
<A NAME="160"></A>    
<A NAME="161"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String promptFD(ByteBuffer bb, <FONT ID="Int">int</FONT> maxlen) {
<A NAME="162"></A>        <FONT ID="If">if</FONT> (bb.limit() &lt; <FONT ID="IntegerLiteral">8</FONT>)
<A NAME="163"></A>            <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">""</FONT>;
<A NAME="164"></A>
<A NAME="165"></A>        StringBuffer sb = <FONT ID="New">new</FONT> StringBuffer(bb.limit());
<A NAME="166"></A>        bb.rewind();
<A NAME="167"></A>        sb.append(bb.getDouble());
<A NAME="168"></A>        <FONT ID="While">while</FONT> (bb.remaining() &gt;= <FONT ID="IntegerLiteral">8</FONT> &amp;&amp; sb.length() &lt; maxlen)
<A NAME="169"></A>            sb.append(<FONT ID="CharacerLiteral">'\\'</FONT>).append(bb.getDouble());
<A NAME="170"></A>
<A NAME="171"></A>        <FONT ID="Return">return</FONT> truncate(sb.toString(), maxlen);        
<A NAME="172"></A>    }
<A NAME="173"></A>    
<A NAME="174"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String promptFL(ByteBuffer bb, <FONT ID="Int">int</FONT> maxlen) {
<A NAME="175"></A>        <FONT ID="If">if</FONT> (bb.limit() &lt; <FONT ID="IntegerLiteral">4</FONT>)
<A NAME="176"></A>            <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">""</FONT>;
<A NAME="177"></A>
<A NAME="178"></A>        StringBuffer sb = <FONT ID="New">new</FONT> StringBuffer(bb.limit());
<A NAME="179"></A>        bb.rewind();
<A NAME="180"></A>        sb.append(bb.getFloat());
<A NAME="181"></A>        <FONT ID="While">while</FONT> (bb.remaining() &gt;= <FONT ID="IntegerLiteral">4</FONT> &amp;&amp; sb.length() &lt; maxlen)
<A NAME="182"></A>            sb.append(<FONT ID="CharacerLiteral">'\\'</FONT>).append(bb.getFloat());
<A NAME="183"></A>
<A NAME="184"></A>        <FONT ID="Return">return</FONT> truncate(sb.toString(), maxlen);        
<A NAME="185"></A>    }
<A NAME="186"></A>
<A NAME="187"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String promptOB(ByteBuffer bb, <FONT ID="Int">int</FONT> maxlen) {
<A NAME="188"></A>        <FONT ID="Return">return</FONT> promptBytes(bb.array(), bb.arrayOffset(), bb.limit(), maxlen);
<A NAME="189"></A>    }
<A NAME="190"></A>    
<A NAME="191"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String promptOF(ByteBuffer bb, <FONT ID="Int">int</FONT> maxlen) {
<A NAME="192"></A>        <FONT ID="Return">return</FONT> promptFL(bb, maxlen);
<A NAME="193"></A>    }
<A NAME="194"></A>    
<A NAME="195"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String promptOW(ByteBuffer bb, <FONT ID="Int">int</FONT> maxlen) {
<A NAME="196"></A>        <FONT ID="Int">int</FONT> l = bb.limit() / <FONT ID="IntegerLiteral">2</FONT> * <FONT ID="IntegerLiteral">5</FONT> - <FONT ID="IntegerLiteral">1</FONT>;
<A NAME="197"></A>        <FONT ID="If">if</FONT> (l &lt; <FONT ID="IntegerLiteral">0</FONT>)
<A NAME="198"></A>            <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">""</FONT>;
<A NAME="199"></A>        
<A NAME="200"></A>        StringBuffer sb = <FONT ID="New">new</FONT> StringBuffer(l);
<A NAME="201"></A>        bb.rewind();
<A NAME="202"></A>        Tags.toHexString(sb, bb.getShort() &amp; <FONT ID="IntegerLiteral">0xffff</FONT>, <FONT ID="IntegerLiteral">4</FONT>);
<A NAME="203"></A>        <FONT ID="While">while</FONT> (bb.remaining() &gt;= <FONT ID="IntegerLiteral">2</FONT> &amp;&amp; sb.length() &lt; maxlen)
<A NAME="204"></A>            Tags.toHexString(sb.append(<FONT ID="CharacerLiteral">'\\'</FONT>), bb.getShort() &amp; <FONT ID="IntegerLiteral">0xffff</FONT>, <FONT ID="IntegerLiteral">4</FONT>);
<A NAME="205"></A>                
<A NAME="206"></A>        <FONT ID="Return">return</FONT> truncate(sb.toString(), maxlen);        
<A NAME="207"></A>    }
<A NAME="208"></A>
<A NAME="209"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String promptSL(ByteBuffer bb, <FONT ID="Int">int</FONT> maxlen) {
<A NAME="210"></A>        <FONT ID="If">if</FONT> (bb.limit() &lt; <FONT ID="IntegerLiteral">4</FONT>)
<A NAME="211"></A>            <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">""</FONT>;
<A NAME="212"></A>
<A NAME="213"></A>        StringBuffer sb = <FONT ID="New">new</FONT> StringBuffer(bb.limit());
<A NAME="214"></A>        bb.rewind();
<A NAME="215"></A>        sb.append(bb.getInt());
<A NAME="216"></A>        <FONT ID="While">while</FONT> (bb.remaining() &gt;= <FONT ID="IntegerLiteral">4</FONT> &amp;&amp; sb.length() &lt; maxlen)
<A NAME="217"></A>            sb.append(<FONT ID="CharacerLiteral">'\\'</FONT>).append(bb.getInt());
<A NAME="218"></A>
<A NAME="219"></A>        <FONT ID="Return">return</FONT> truncate(sb.toString(), maxlen);        
<A NAME="220"></A>    }
<A NAME="221"></A>    
<A NAME="222"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String promptSS(ByteBuffer bb, <FONT ID="Int">int</FONT> maxlen) {
<A NAME="223"></A>        <FONT ID="If">if</FONT> (bb.limit() &lt; <FONT ID="IntegerLiteral">2</FONT>)
<A NAME="224"></A>            <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">""</FONT>;
<A NAME="225"></A>
<A NAME="226"></A>        StringBuffer sb = <FONT ID="New">new</FONT> StringBuffer(bb.limit());
<A NAME="227"></A>        bb.rewind();
<A NAME="228"></A>        sb.append(bb.getShort());
<A NAME="229"></A>        <FONT ID="While">while</FONT> (bb.remaining() &gt;= <FONT ID="IntegerLiteral">2</FONT> &amp;&amp; sb.length() &lt; maxlen)
<A NAME="230"></A>            sb.append(<FONT ID="CharacerLiteral">'\\'</FONT>).append(bb.getShort());
<A NAME="231"></A>
<A NAME="232"></A>        <FONT ID="Return">return</FONT> truncate(sb.toString(), maxlen);        
<A NAME="233"></A>    }
<A NAME="234"></A>    
<A NAME="235"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String promptUL(ByteBuffer bb, <FONT ID="Int">int</FONT> maxlen) {
<A NAME="236"></A>        <FONT ID="If">if</FONT> (bb.limit() &lt; <FONT ID="IntegerLiteral">4</FONT>)
<A NAME="237"></A>            <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">""</FONT>;
<A NAME="238"></A>
<A NAME="239"></A>        StringBuffer sb = <FONT ID="New">new</FONT> StringBuffer(bb.limit());
<A NAME="240"></A>        bb.rewind();
<A NAME="241"></A>        sb.append(bb.getInt() &amp; <FONT ID="IntegerLiteral">0xffffffffL</FONT>);
<A NAME="242"></A>        <FONT ID="While">while</FONT> (bb.remaining() &gt;= <FONT ID="IntegerLiteral">4</FONT> &amp;&amp; sb.length() &lt; maxlen)
<A NAME="243"></A>            sb.append(<FONT ID="CharacerLiteral">'\\'</FONT>).append(bb.getInt() &amp; <FONT ID="IntegerLiteral">0xffffffffL</FONT>);
<A NAME="244"></A>
<A NAME="245"></A>        <FONT ID="Return">return</FONT> truncate(sb.toString(), maxlen);        
<A NAME="246"></A>    }
<A NAME="247"></A>    
<A NAME="248"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String promptUS(ByteBuffer bb, <FONT ID="Int">int</FONT> maxlen) {
<A NAME="249"></A>        <FONT ID="If">if</FONT> (bb.limit() &lt; <FONT ID="IntegerLiteral">2</FONT>)
<A NAME="250"></A>            <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">""</FONT>;
<A NAME="251"></A>
<A NAME="252"></A>        StringBuffer sb = <FONT ID="New">new</FONT> StringBuffer(bb.limit());
<A NAME="253"></A>        bb.rewind();
<A NAME="254"></A>        sb.append(bb.getShort() &amp; <FONT ID="IntegerLiteral">0xffff</FONT>);
<A NAME="255"></A>        <FONT ID="While">while</FONT> (bb.remaining() &gt;= <FONT ID="IntegerLiteral">2</FONT> &amp;&amp; sb.length() &lt; maxlen)
<A NAME="256"></A>            sb.append(<FONT ID="CharacerLiteral">'\\'</FONT>).append(bb.getShort() &amp; <FONT ID="IntegerLiteral">0xffff</FONT>);
<A NAME="257"></A>
<A NAME="258"></A>        <FONT ID="Return">return</FONT> truncate(sb.toString(), maxlen);        
<A NAME="259"></A>    }
<A NAME="260"></A>
<A NAME="261"></A>    <FONT ID="Static">static</FONT> <FONT ID="Final">final</FONT> <FONT ID="Byte">byte</FONT>[] b0 = {};
<A NAME="262"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> <FONT ID="Byte">byte</FONT>[] parseValue(<FONT ID="Int">int</FONT> vr, String str, Charset cs) {
<A NAME="263"></A>        <FONT ID="If">if</FONT> (str.length() == <FONT ID="IntegerLiteral">0</FONT>)
<A NAME="264"></A>            <FONT ID="Return">return</FONT> b0;
<A NAME="265"></A>        
<A NAME="266"></A>        <FONT ID="If">if</FONT> (VRs.isStringValue(vr)) {
<A NAME="267"></A>            <FONT ID="Return">return</FONT> cs.encode(CharBuffer.wrap(str)).array();
<A NAME="268"></A>        }
<A NAME="269"></A>        <FONT ID="Switch">switch</FONT> (vr) {
<A NAME="270"></A>            <FONT ID="Case">case</FONT> VRs.AT:
<A NAME="271"></A>                <FONT ID="Return">return</FONT> parseAT(str);
<A NAME="272"></A>            <FONT ID="Case">case</FONT> VRs.FD:
<A NAME="273"></A>                <FONT ID="Return">return</FONT> parseFD(str);
<A NAME="274"></A>            <FONT ID="Case">case</FONT> VRs.FL:
<A NAME="275"></A>                <FONT ID="Return">return</FONT> parseFL(str);
<A NAME="276"></A>            <FONT ID="Case">case</FONT> VRs.OB: <FONT ID="Case">case</FONT> VRs.UN:
<A NAME="277"></A>                <FONT ID="Return">return</FONT> parseBytes(str);
<A NAME="278"></A>            <FONT ID="Case">case</FONT> VRs.OF:
<A NAME="279"></A>                <FONT ID="Return">return</FONT> parseOF(str);
<A NAME="280"></A>            <FONT ID="Case">case</FONT> VRs.OW:
<A NAME="281"></A>                <FONT ID="Return">return</FONT> parseOW(str);
<A NAME="282"></A>            <FONT ID="Case">case</FONT> VRs.SS: <FONT ID="Case">case</FONT> VRs.US:
<A NAME="283"></A>                <FONT ID="Return">return</FONT> parseSS_US(str);
<A NAME="284"></A>            <FONT ID="Case">case</FONT> VRs.SL: <FONT ID="Case">case</FONT> VRs.UL:
<A NAME="285"></A>                <FONT ID="Return">return</FONT> parseSL_UL(str);
<A NAME="286"></A>        }
<A NAME="287"></A>        <FONT ID="Throw">throw</FONT> <FONT ID="New">new</FONT> IllegalArgumentException(<FONT ID="StringLiteral">"VR:"</FONT> + VRs.toString(vr));
<A NAME="288"></A>    }
<A NAME="289"></A>
<A NAME="290"></A>    <FONT ID="Static">static</FONT> <FONT ID="Final">final</FONT> String[] EMPTY_STRING_ARRAY = {};
<A NAME="291"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String[] split(String s, <FONT ID="Char">char</FONT> delim) {
<A NAME="292"></A>        <FONT ID="If">if</FONT> (s == <FONT ID="Null">null</FONT>) {
<A NAME="293"></A>            <FONT ID="Return">return</FONT> <FONT ID="Null">null</FONT>;
<A NAME="294"></A>        }
<A NAME="295"></A>        <FONT ID="If">if</FONT> (s.length() == <FONT ID="IntegerLiteral">0</FONT>) {
<A NAME="296"></A>            <FONT ID="Return">return</FONT> EMPTY_STRING_ARRAY;
<A NAME="297"></A>        }
<A NAME="298"></A>        <FONT ID="Final">final</FONT> <FONT ID="Int">int</FONT> r0 = s.indexOf(delim);
<A NAME="299"></A>        <FONT ID="If">if</FONT> (r0 == -<FONT ID="IntegerLiteral">1</FONT>)
<A NAME="300"></A>            <FONT ID="Return">return</FONT> <FONT ID="New">new</FONT> String[]{s};
<A NAME="301"></A>        <FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">2</FONT>;
<A NAME="302"></A>        <FONT ID="Int">int</FONT> l, r = r0;
<A NAME="303"></A>        <FONT ID="For">for</FONT> (; (r = s.indexOf(delim, l = r + <FONT ID="IntegerLiteral">1</FONT>)) != -<FONT ID="IntegerLiteral">1</FONT>; ++i);
<A NAME="304"></A>        String[] retval = <FONT ID="New">new</FONT> String[i];
<A NAME="305"></A>        i = l = <FONT ID="IntegerLiteral">0</FONT>;
<A NAME="306"></A>        r = r0;
<A NAME="307"></A>        <FONT ID="Do">do</FONT> retval[i++] = s.substring(l, r);
<A NAME="308"></A>        <FONT ID="While">while</FONT> ((r = s.indexOf(delim, l = r + <FONT ID="IntegerLiteral">1</FONT>)) != -<FONT ID="IntegerLiteral">1</FONT>);
<A NAME="309"></A>        retval[i] = s.substring(l);
<A NAME="310"></A>        <FONT ID="Return">return</FONT> retval;
<A NAME="311"></A>    }
<A NAME="312"></A>
<A NAME="313"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> <FONT ID="Int">int</FONT> count(String s, <FONT ID="Char">char</FONT> delim) {
<A NAME="314"></A>        <FONT ID="If">if</FONT> (s == <FONT ID="Null">null</FONT>) <FONT ID="Return">return</FONT> <FONT ID="IntegerLiteral">0</FONT>;
<A NAME="315"></A>        <FONT ID="Int">int</FONT> c = <FONT ID="IntegerLiteral">0</FONT>;
<A NAME="316"></A>        <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> pos = -<FONT ID="IntegerLiteral">1</FONT>; (pos = s.indexOf(delim, pos+<FONT ID="IntegerLiteral">1</FONT>)) != -<FONT ID="IntegerLiteral">1</FONT>; c++);
<A NAME="317"></A>        <FONT ID="Return">return</FONT> c;
<A NAME="318"></A>    }
<A NAME="319"></A>    
<A NAME="320"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String toString(String[] a, <FONT ID="Char">char</FONT> delim) {
<A NAME="321"></A>        <FONT ID="If">if</FONT> (a == <FONT ID="Null">null</FONT>) {
<A NAME="322"></A>            <FONT ID="Return">return</FONT> <FONT ID="Null">null</FONT>;
<A NAME="323"></A>        }
<A NAME="324"></A>        <FONT ID="If">if</FONT> (a.length == <FONT ID="IntegerLiteral">0</FONT>) {
<A NAME="325"></A>            <FONT ID="Return">return</FONT> <FONT ID="StringLiteral">""</FONT>;
<A NAME="326"></A>        }
<A NAME="327"></A>        <FONT ID="If">if</FONT> (a.length == <FONT ID="IntegerLiteral">1</FONT>) {
<A NAME="328"></A>            <FONT ID="Return">return</FONT> a[<FONT ID="IntegerLiteral">0</FONT>];
<A NAME="329"></A>        }
<A NAME="330"></A>        StringBuffer sb = <FONT ID="New">new</FONT> StringBuffer(a[<FONT ID="IntegerLiteral">0</FONT>]);
<A NAME="331"></A>        <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">1</FONT>; i &lt; a.length; ++i) {
<A NAME="332"></A>            sb.append(delim).append(a[i]);
<A NAME="333"></A>        }
<A NAME="334"></A>        <FONT ID="Return">return</FONT> sb.toString();
<A NAME="335"></A>    }
<A NAME="336"></A>    
<A NAME="337"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> <FONT ID="Byte">byte</FONT>[] parseAT(String str) {
<A NAME="338"></A>        String[] a = split(str,<FONT ID="CharacerLiteral">'\\'</FONT>);
<A NAME="339"></A>        <FONT ID="Byte">byte</FONT>[] b = <FONT ID="New">new</FONT> <FONT ID="Byte">byte</FONT>[a.length * <FONT ID="IntegerLiteral">4</FONT>];
<A NAME="340"></A>        ByteBuffer bb = ByteBuffer.wrap(b, <FONT ID="IntegerLiteral">0</FONT>, b.length)
<A NAME="341"></A>                .order(ByteOrder.LITTLE_ENDIAN);
<A NAME="342"></A>        <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; a.length; ++i) {
<A NAME="343"></A>            <FONT ID="Int">int</FONT> tag = (<FONT ID="Int">int</FONT>)Long.parseLong(a[i],<FONT ID="IntegerLiteral">16</FONT>);
<A NAME="344"></A>            bb.putShort((<FONT ID="Short">short</FONT>)(tag &gt;&gt;&gt; <FONT ID="IntegerLiteral">16</FONT>));
<A NAME="345"></A>            bb.putShort((<FONT ID="Short">short</FONT>)tag);
<A NAME="346"></A>        }
<A NAME="347"></A>        <FONT ID="Return">return</FONT> b;
<A NAME="348"></A>    }
<A NAME="349"></A>    
<A NAME="350"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> <FONT ID="Byte">byte</FONT>[] parseFD(String str) {
<A NAME="351"></A>        String[] a = split(str,<FONT ID="CharacerLiteral">'\\'</FONT>);
<A NAME="352"></A>        <FONT ID="Byte">byte</FONT>[] b = <FONT ID="New">new</FONT> <FONT ID="Byte">byte</FONT>[a.length * <FONT ID="IntegerLiteral">8</FONT>];
<A NAME="353"></A>        ByteBuffer bb = ByteBuffer.wrap(b, <FONT ID="IntegerLiteral">0</FONT>, b.length)
<A NAME="354"></A>                .order(ByteOrder.LITTLE_ENDIAN);
<A NAME="355"></A>        <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; a.length; ++i)
<A NAME="356"></A>            bb.putDouble(Double.parseDouble(a[i]));
<A NAME="357"></A>        <FONT ID="Return">return</FONT> b;
<A NAME="358"></A>    }
<A NAME="359"></A>    
<A NAME="360"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> <FONT ID="Byte">byte</FONT>[] parseFL(String str) {
<A NAME="361"></A>        String[] a = split(str,<FONT ID="CharacerLiteral">'\\'</FONT>);
<A NAME="362"></A>        <FONT ID="Byte">byte</FONT>[] b = <FONT ID="New">new</FONT> <FONT ID="Byte">byte</FONT>[a.length * <FONT ID="IntegerLiteral">4</FONT>];
<A NAME="363"></A>        ByteBuffer bb = ByteBuffer.wrap(b, <FONT ID="IntegerLiteral">0</FONT>, b.length)
<A NAME="364"></A>                .order(ByteOrder.LITTLE_ENDIAN);
<A NAME="365"></A>        <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; a.length; ++i)
<A NAME="366"></A>            bb.putFloat(Float.parseFloat(a[i]));
<A NAME="367"></A>        <FONT ID="Return">return</FONT> b;
<A NAME="368"></A>    }
<A NAME="369"></A>
<A NAME="370"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> <FONT ID="Byte">byte</FONT>[] parseOF(String str) {
<A NAME="371"></A>        <FONT ID="Return">return</FONT> parseFL(str);
<A NAME="372"></A>    }
<A NAME="373"></A>    
<A NAME="374"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> <FONT ID="Byte">byte</FONT>[] parseBytes(String str) {
<A NAME="375"></A>        <FONT ID="Byte">byte</FONT>[] b = <FONT ID="New">new</FONT> <FONT ID="Byte">byte</FONT>[(str.length()+<FONT ID="IntegerLiteral">1</FONT>)/<FONT ID="IntegerLiteral">3</FONT>];
<A NAME="376"></A>        <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>, l = <FONT ID="IntegerLiteral">0</FONT>; i &lt; b.length; ++i, l+=<FONT ID="IntegerLiteral">3</FONT>)
<A NAME="377"></A>            b[i++] = (<FONT ID="Byte">byte</FONT>)Short.parseShort(str.substring(l, l+<FONT ID="IntegerLiteral">2</FONT>), <FONT ID="IntegerLiteral">16</FONT>);
<A NAME="378"></A>        <FONT ID="Return">return</FONT> b;
<A NAME="379"></A>    }
<A NAME="380"></A>    
<A NAME="381"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> <FONT ID="Byte">byte</FONT>[] parseOW(String str) {
<A NAME="382"></A>        <FONT ID="Byte">byte</FONT>[] b = <FONT ID="New">new</FONT> <FONT ID="Byte">byte</FONT>[(str.length()+<FONT ID="IntegerLiteral">1</FONT>)/<FONT ID="IntegerLiteral">5</FONT>];
<A NAME="383"></A>        <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>, l = <FONT ID="IntegerLiteral">0</FONT>; i &lt; b.length; l+=<FONT ID="IntegerLiteral">5</FONT>) {
<A NAME="384"></A>            <FONT ID="Short">short</FONT> s = (<FONT ID="Short">short</FONT>)Integer.parseInt(str.substring(l, l+<FONT ID="IntegerLiteral">4</FONT>), <FONT ID="IntegerLiteral">16</FONT>);
<A NAME="385"></A>            b[i++] = (<FONT ID="Byte">byte</FONT>)(s);
<A NAME="386"></A>            b[i++] = (<FONT ID="Byte">byte</FONT>)(s &gt;&gt;&gt; <FONT ID="IntegerLiteral">8</FONT>);
<A NAME="387"></A>        }
<A NAME="388"></A>        <FONT ID="Return">return</FONT> b;
<A NAME="389"></A>    }
<A NAME="390"></A>
<A NAME="391"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> <FONT ID="Byte">byte</FONT>[] parseSS_US(String str) {
<A NAME="392"></A>        String[] a = split(str,<FONT ID="CharacerLiteral">'\\'</FONT>);
<A NAME="393"></A>        <FONT ID="Byte">byte</FONT>[] b = <FONT ID="New">new</FONT> <FONT ID="Byte">byte</FONT>[a.length * <FONT ID="IntegerLiteral">2</FONT>];
<A NAME="394"></A>        ByteBuffer bb = ByteBuffer.wrap(b, <FONT ID="IntegerLiteral">0</FONT>, b.length)
<A NAME="395"></A>                .order(ByteOrder.LITTLE_ENDIAN);
<A NAME="396"></A>        <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; a.length; ++i)
<A NAME="397"></A>            bb.putShort((<FONT ID="Short">short</FONT>)Integer.parseInt(a[i]));
<A NAME="398"></A>        <FONT ID="Return">return</FONT> b;
<A NAME="399"></A>    }
<A NAME="400"></A>    
<A NAME="401"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> <FONT ID="Byte">byte</FONT>[] parseSL_UL(String str) {
<A NAME="402"></A>        String[] a = split(str,<FONT ID="CharacerLiteral">'\\'</FONT>);
<A NAME="403"></A>        <FONT ID="Byte">byte</FONT>[] b = <FONT ID="New">new</FONT> <FONT ID="Byte">byte</FONT>[a.length * <FONT ID="IntegerLiteral">4</FONT>];
<A NAME="404"></A>        ByteBuffer bb = ByteBuffer.wrap(b, <FONT ID="IntegerLiteral">0</FONT>, b.length)
<A NAME="405"></A>                .order(ByteOrder.LITTLE_ENDIAN);
<A NAME="406"></A>        <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; a.length; ++i)
<A NAME="407"></A>            bb.putInt((<FONT ID="Int">int</FONT>)Long.parseLong(a[i]));
<A NAME="408"></A>        <FONT ID="Return">return</FONT> b;
<A NAME="409"></A>    }
<A NAME="410"></A>    
<A NAME="411"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> <FONT ID="Float">float</FONT>[] parseFloats(String[] values) {
<A NAME="412"></A>        <FONT ID="Float">float</FONT>[] retval = <FONT ID="New">new</FONT> <FONT ID="Float">float</FONT>[values.length];
<A NAME="413"></A>        <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; retval.length; ++i) {
<A NAME="414"></A>            retval[i] = Float.parseFloat(values[i]);
<A NAME="415"></A>        }
<A NAME="416"></A>        <FONT ID="Return">return</FONT> retval;
<A NAME="417"></A>    }
<A NAME="418"></A>    
<A NAME="419"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> <FONT ID="Double">double</FONT>[] parseDoubles(String[] values) {
<A NAME="420"></A>        <FONT ID="Double">double</FONT>[] retval = <FONT ID="New">new</FONT> <FONT ID="Double">double</FONT>[values.length];
<A NAME="421"></A>        <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; retval.length; ++i) {
<A NAME="422"></A>            retval[i] = Double.parseDouble(values[i]);
<A NAME="423"></A>        }
<A NAME="424"></A>        <FONT ID="Return">return</FONT> retval;
<A NAME="425"></A>    }
<A NAME="426"></A>
<A NAME="427"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> <FONT ID="Int">int</FONT> parseInt(String value, <FONT ID="Long">long</FONT> min, <FONT ID="Long">long</FONT> max) {
<A NAME="428"></A>        <FONT ID="Long">long</FONT> retval = Long.parseLong(value);
<A NAME="429"></A>        <FONT ID="If">if</FONT> (retval &lt; min || retval &gt; max) {
<A NAME="430"></A>            <FONT ID="Throw">throw</FONT> <FONT ID="New">new</FONT> NumberFormatException(<FONT ID="StringLiteral">"value: "</FONT> + value
<A NAME="431"></A>                    + <FONT ID="StringLiteral">", min:"</FONT> + min + <FONT ID="StringLiteral">", max:"</FONT> + max);
<A NAME="432"></A>        }
<A NAME="433"></A>        <FONT ID="Return">return</FONT> (<FONT ID="Int">int</FONT>)retval;
<A NAME="434"></A>    }
<A NAME="435"></A>    
<A NAME="436"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> <FONT ID="Int">int</FONT>[] parseInts(String[] values, <FONT ID="Long">long</FONT> min, <FONT ID="Long">long</FONT> max) {
<A NAME="437"></A>        <FONT ID="Int">int</FONT>[] retval = <FONT ID="New">new</FONT> <FONT ID="Int">int</FONT>[values.length];
<A NAME="438"></A>        <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; retval.length; ++i) {
<A NAME="439"></A>            retval[i] = parseInt(values[i], min, max);
<A NAME="440"></A>        }
<A NAME="441"></A>        <FONT ID="Return">return</FONT> retval;
<A NAME="442"></A>    }
<A NAME="443"></A>    
<A NAME="444"></A>    <FONT ID="Private">private</FONT> <FONT ID="Static">static</FONT> <FONT ID="Final">final</FONT> <FONT ID="Int">int</FONT> UID_DIGIT1 = <FONT ID="IntegerLiteral">0</FONT>;
<A NAME="445"></A>    <FONT ID="Private">private</FONT> <FONT ID="Static">static</FONT> <FONT ID="Final">final</FONT> <FONT ID="Int">int</FONT> UID_DIGIT = <FONT ID="IntegerLiteral">1</FONT>;
<A NAME="446"></A>    <FONT ID="Private">private</FONT> <FONT ID="Static">static</FONT> <FONT ID="Final">final</FONT> <FONT ID="Int">int</FONT> UID_DOT = <FONT ID="IntegerLiteral">2</FONT>;
<A NAME="447"></A>    <FONT ID="Private">private</FONT> <FONT ID="Static">static</FONT> <FONT ID="Final">final</FONT> <FONT ID="Int">int</FONT> UID_ERROR = -<FONT ID="IntegerLiteral">1</FONT>;
<A NAME="448"></A>    <FONT ID="Private">private</FONT> <FONT ID="Static">static</FONT> <FONT ID="Int">int</FONT> nextState(<FONT ID="Int">int</FONT> state, <FONT ID="Char">char</FONT> c)
<A NAME="449"></A>    {
<A NAME="450"></A>       <FONT ID="Switch">switch</FONT> (state)
<A NAME="451"></A>       {
<A NAME="452"></A>          <FONT ID="Case">case</FONT> UID_DIGIT1:
<A NAME="453"></A>             <FONT ID="If">if</FONT> (c &gt; <FONT ID="CharacerLiteral">'0'</FONT> &amp;&amp; c &lt;= <FONT ID="CharacerLiteral">'9'</FONT>)
<A NAME="454"></A>                <FONT ID="Return">return</FONT> UID_DIGIT;
<A NAME="455"></A>             <FONT ID="If">if</FONT> (c == <FONT ID="CharacerLiteral">'0'</FONT>)
<A NAME="456"></A>                <FONT ID="Return">return</FONT> UID_DOT;
<A NAME="457"></A>             <FONT ID="Return">return</FONT> UID_ERROR;
<A NAME="458"></A>          <FONT ID="Case">case</FONT> UID_DIGIT:
<A NAME="459"></A>             <FONT ID="If">if</FONT> (c &gt;= <FONT ID="CharacerLiteral">'0'</FONT> &amp;&amp; c &lt;= <FONT ID="CharacerLiteral">'9'</FONT>)
<A NAME="460"></A>                <FONT ID="Return">return</FONT> UID_DIGIT;
<A NAME="461"></A>             <FONT ID="SingleLineComment">// fall through
<A NAME="462"></A></FONT>          <FONT ID="Case">case</FONT> UID_DOT:
<A NAME="463"></A>             <FONT ID="If">if</FONT> (c == <FONT ID="CharacerLiteral">'.'</FONT>)
<A NAME="464"></A>                <FONT ID="Return">return</FONT> UID_DIGIT1;
<A NAME="465"></A>             <FONT ID="SingleLineComment">// fall through
<A NAME="466"></A></FONT>       }
<A NAME="467"></A>       <FONT ID="Return">return</FONT> UID_ERROR;
<A NAME="468"></A>    }
<A NAME="469"></A>    
<A NAME="470"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String checkUID(String s)
<A NAME="471"></A>    {
<A NAME="472"></A>       <FONT ID="Char">char</FONT>[] a = s.toCharArray();
<A NAME="473"></A>       <FONT ID="If">if</FONT> (a.length == <FONT ID="IntegerLiteral">0</FONT> || a.length &gt; <FONT ID="IntegerLiteral">64</FONT>)
<A NAME="474"></A>          <FONT ID="Throw">throw</FONT> <FONT ID="New">new</FONT> IllegalArgumentException(s);
<A NAME="475"></A>       
<A NAME="476"></A>       <FONT ID="Int">int</FONT> state = UID_DIGIT1;
<A NAME="477"></A>       <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; a.length; ++i)
<A NAME="478"></A>       {
<A NAME="479"></A>          <FONT ID="If">if</FONT> ((state = nextState(state, a[i])) == UID_ERROR)
<A NAME="480"></A>             <FONT ID="Throw">throw</FONT> <FONT ID="New">new</FONT> IllegalArgumentException(s);
<A NAME="481"></A>       }
<A NAME="482"></A>       <FONT ID="If">if</FONT> (state == UID_DIGIT1)
<A NAME="483"></A>          <FONT ID="Throw">throw</FONT> <FONT ID="New">new</FONT> IllegalArgumentException(s);
<A NAME="484"></A>
<A NAME="485"></A>       <FONT ID="Return">return</FONT> s;
<A NAME="486"></A>    }
<A NAME="487"></A>
<A NAME="488"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String[] checkUIDs(String[] a)
<A NAME="489"></A>    {
<A NAME="490"></A>       <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; a.length; ++i)
<A NAME="491"></A>       {
<A NAME="492"></A>          checkUID(a[i]);
<A NAME="493"></A>       }
<A NAME="494"></A>       <FONT ID="Return">return</FONT> a;
<A NAME="495"></A>    }
<A NAME="496"></A>        
<A NAME="497"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String checkAET(String s)
<A NAME="498"></A>    {
<A NAME="499"></A>       <FONT ID="Char">char</FONT>[] a = s.toCharArray();
<A NAME="500"></A>       <FONT ID="If">if</FONT> (a.length == <FONT ID="IntegerLiteral">0</FONT> || a.length &gt; <FONT ID="IntegerLiteral">16</FONT>)
<A NAME="501"></A>          <FONT ID="Throw">throw</FONT> <FONT ID="New">new</FONT> IllegalArgumentException(s);
<A NAME="502"></A>
<A NAME="503"></A>       <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; a.length; ++i)
<A NAME="504"></A>       {
<A NAME="505"></A>          <FONT ID="If">if</FONT> (a[i] &lt; <FONT ID="CharacerLiteral">' '</FONT> || a[i] &gt;= <FONT ID="CharacerLiteral">''</FONT>)
<A NAME="506"></A>             <FONT ID="Throw">throw</FONT> <FONT ID="New">new</FONT> IllegalArgumentException(s);
<A NAME="507"></A>       }
<A NAME="508"></A>       <FONT ID="Return">return</FONT> s;
<A NAME="509"></A>    }
<A NAME="510"></A>
<A NAME="511"></A>    <FONT ID="Public">public</FONT> <FONT ID="Static">static</FONT> String[] checkAETs(String[] a)
<A NAME="512"></A>    {
<A NAME="513"></A>       <FONT ID="For">for</FONT> (<FONT ID="Int">int</FONT> i = <FONT ID="IntegerLiteral">0</FONT>; i &lt; a.length; ++i)
<A NAME="514"></A>       {
<A NAME="515"></A>          checkAET(a[i]);
<A NAME="516"></A>       }
<A NAME="517"></A>       <FONT ID="Return">return</FONT> a;
<A NAME="518"></A>    }
<A NAME="519"></A>        
<A NAME="520"></A>}
<A NAME="521"></A></pre><TABLE id="Header" border="0" cellpadding="0" cellspacing="0" width="100%">
<tr>
<td colspan="2" width="33%">&nbsp;</td>
<td align="center" colspan="2" width="33%">
<font size="4">StringUtils</font>
</td>
<td align="right" colspan="2" width="33%"></td>
</tr>
</TABLE>

</BODY>
</HTML>